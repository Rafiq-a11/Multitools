<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>‡¶¶‡¶≤‡¶ø‡¶≤ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶ú‡¶Æ‡¶ø‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ (By Israt Computer)</title>
  <style>
    body {
      font-family: 'Siyam Rupali', Arial, sans-serif;
      padding: 20px;
      background: #f2f2f2;
      min-width: 320px;
      position: relative;
      min-height: 100vh;
      padding-bottom: 140px;
    }
    h1 {
      text-align: center;
      margin-bottom: 5px;
      font-weight: 700;
      color: #2c3e50;
    }
    h2 {
      text-align: center;
      margin-top: 0;
      margin-bottom: 20px;
      color: #34495e;
      font-weight: 500;
    }
    form, #result, .action-buttons {
      background: #fff;
      padding: 20px 25px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      margin-bottom: 25px;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }
    label {
      display: block;
      margin: 10px 0 6px;
      font-weight: 600;
      color: #2c3e50;
    }
    input[type="text"], input[type="number"], input[type="date"] {
      width: 100%;
      padding: 8px 10px;
      font-size: 15px;
      border: 1.5px solid #ccc;
      border-radius: 6px;
      transition: border-color 0.3s;
      box-sizing: border-box;
    }
    input[type="text"]:focus, input[type="number"]:focus, input[type="date"]:focus {
      border-color: #2980b9;
      outline: none;
      background: #f0f8ff;
    }
    .deed-block, .khatian-block {
      border: 1.5px dashed #bbb;
      padding: 15px 20px;
      margin-bottom: 20px;
      background: #fafafa;
      border-radius: 8px;
      box-shadow: inset 0 1px 4px rgba(0,0,0,0.05);
    }
    .deed-header {
      font-size: 18px;
      font-weight: 700;
      color: #1a5276;
      margin-bottom: 12px;
      border-bottom: 2px solid #2980b9;
      padding-bottom: 6px;
    }
    .khatian-block {
      background: #fff;
      border: 1px solid #ddd;
      box-shadow: none;
    }
    .dag-group {
      margin-left: 20px;
      margin-bottom: 12px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }
    button {
      margin-top: 12px;
      margin-right: 12px;
      padding: 10px 18px;
      font-size: 15px;
      border: none;
      border-radius: 6px;
      background-color: #3498db;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
      box-shadow: 0 2px 6px rgba(52,152,219,0.4);
      user-select: none;
    }
    button:hover {
      background-color: #2c80b4;
      box-shadow: 0 3px 8px rgba(44,128,180,0.6);
    }
    #addDeedBtn {
      background-color: #27ae60;
      box-shadow: 0 2px 6px rgba(39,174,96,0.5);
    }
    #addDeedBtn:hover {
      background-color: #1e8449;
      box-shadow: 0 3px 8px rgba(30,132,73,0.7);
    }
    .action-buttons {
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      font-size: 14.5px;
    }
    th, td {
      border: 1px solid #999;
      padding: 10px 8px;
      text-align: center;
      font-weight: 500;
      color: #2c3e50;
    }
    th {
      background: #d6eaf8;
      font-weight: 700;
      color: #1a5276;
    }
    @media (max-width: 600px) {
      body {
        padding: 10px;
      }
      form, #result, .action-buttons {
        padding: 15px;
      }
      button {
        width: 100%;
        margin: 8px 0;
      }
      .dag-group {
        margin-left: 0;
      }
    }
    footer {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #2980b9;
      color: white;
      text-align: center;
      padding: 15px 10px;
      font-size: 14px;
      box-shadow: 0 -3px 10px rgba(0,0,0,0.2);
      line-height: 1.4;
      user-select: none;
    }
    footer a {
      color: #f9e79f;
      text-decoration: none;
      font-weight: 600;
    }
    footer a:hover {
      text-decoration: underline;
    }
    .creator-name {
      font-size: 20px;
      font-weight: 700;
    }

    /* ‡¶®‡¶§‡ßÅ‡¶® ‡¶∏‡ßá‡¶≠/‡¶≤‡ßã‡¶° UI */
    #saveNameInput, #loadNameInput {
      padding: 8px;
      width: 200px;
      border-radius: 6px;
      border: 1.5px solid #ccc;
      margin-right: 8px;
      margin-bottom: 12px;
      font-size: 15px;
    }
    #savedList {
      max-width: 900px;
      margin: 15px auto;
      background: #fff;
      padding: 10px;
      border-radius: 6px;
      max-height: 150px;
      overflow: auto;
      text-align: left;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      font-size: 15px;
      color: #2c3e50;
    }
    #savedList ul {
      list-style: none;
      padding-left: 0;
      margin: 0;
    }
    #savedList li {
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    #savedList button {
      margin: 0;
      background: #e74c3c;
      border: none;
      color: #fff;
      border-radius: 4px;
      padding: 4px 10px;
      cursor: pointer;
      font-size: 14px;
      flex-shrink: 0;
    }
  </style>
</head>
<body>
  <button onclick="goBack()">‚Üê ‡¶Æ‡ßá‡¶®‡ßÅ‡¶§‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®</button>

  <script>
    const { ipcRenderer } = require('electron');

    function goBack() {
      ipcRenderer.send('open-tool', 'home.html');
    }
   </script>
</body>

  <h1>‡¶¶‡¶≤‡¶ø‡¶≤ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶ï ‡¶ú‡¶Æ‡¶ø‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</h1>
  <h2>By Israt Computer</h2>

  <form id="landForm" novalidate>
    <div id="deedContainer"></div>
    <button type="button" id="addDeedBtn">‚ûï ‡¶®‡¶§‡ßÅ‡¶® ‡¶¶‡¶≤‡¶ø‡¶≤ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <button type="submit">üìä ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
  </form>

  <div id="result"></div>

  <div class="action-buttons" style="max-width:900px; margin:auto; text-align:center;">

    <!-- Save name input -->
    <input type="text" id="saveNameInput" placeholder="‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶®" />
    <button id="saveBtn" style="background:#27ae60;">üíæ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>

    <br>

    <!-- Load name input -->
    <input type="text" id="loadNameInput" placeholder="‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" />
    <button id="loadBtn" style="background:#2980b9;">üìÇ ‡¶§‡¶•‡ßç‡¶Ø ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</button>

    <br>

    <button id="showAllBtn" style="background:#3498db;">üìã ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶∏‡¶¨ ‡¶®‡¶æ‡¶Æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶ì</button>

    <div id="savedList"></div>

  </div>

  <footer>
    <div><strong>‡¶∏‡¶´‡¶ü‡¶ì‡ßü‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶Æ‡¶æ‡¶§‡¶æ:</strong> <span class="creator-name">‡¶Æ‡ßã‡¶É ‡¶∞‡¶´‡¶ø‡¶ï‡ßÅ‡¶≤ ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ</span>, ‡¶â‡¶¶‡ßç‡¶Ø‡ßã‡¶ï‡ßç‡¶§‡¶æ, ‡¶≠‡ßÇ‡¶Æ‡¶ø ‡¶∏‡ßá‡¶¨‡¶æ ‡¶∏‡¶π‡¶æ‡ßü‡¶§‡¶æ ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞, ‡¶™‡¶æ‡¶•‡¶∞‡¶ò‡¶æ‡¶ü‡¶æ</div>
    <div><strong>‡¶∏‡¶π‡¶æ‡ßü‡¶§‡¶æ‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶®:</strong> <a href="mailto:Rafiqhowlader2013@gmail.com">‡¶á‡¶∏‡¶∞‡¶æ‡¶§ ‡¶ï‡¶Æ‡ßç‡¶™‡¶ø‡¶â‡¶ü‡¶æ‡¶∞, ‡¶â‡¶ï‡¶ø‡¶≤‡¶™‡¶ü‡ßç‡¶ü‡¶ø, ‡¶™‡¶æ‡¶•‡¶∞‡¶ò‡¶æ‡¶ü‡¶æ, ‡¶¨‡¶∞‡¶ó‡ßÅ‡¶®‡¶æ</a></div>
    <div><strong>‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤:</strong> ‡ß¶‡ßß‡ß≠‡ß™‡ß™‡ß©‡ßÆ‡ßØ‡ß´‡ßØ‡ßÆ | <strong>‡¶á‡¶Æ‡ßá‡¶á‡¶≤:</strong> <a href="mailto:Rafiqhowlader2013@gmail.com">Rafiqhowlader2013@gmail.com</a></div>
  </footer>

<script>
  const deedContainer = document.getElementById('deedContainer');
  const addDeedBtn = document.getElementById('addDeedBtn');
  let deedIndex = 0;

  function createDeedBlock(dIndex, data) {
    const block = document.createElement('div');
    block.className = 'deed-block';

    block.innerHTML = `
      <div class="deed-header" style="display:flex; flex-wrap:wrap; align-items:center; gap:10px;">
        <label style="flex:1;">
          ‡¶¶‡¶≤‡¶ø‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞: <input type="text" name="deedNo${dIndex}" required placeholder="‡¶¶‡¶≤‡¶ø‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" style="width:100%; min-width:150px;" value="${data?.deedNo || ''}" />
        </label>
        <label style="flex:1;">
          ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: <input type="date" name="deedDate${dIndex}" required style="width:100%;" value="${data?.deedDate || ''}" />
        </label>
        <button type="button" onclick="this.closest('.deed-block').remove()" style="background:#e74c3c; color:#fff;">üóëÔ∏è</button>
      </div>
      <div class="khatian-list" id="khatianList${dIndex}"></div>
      <button type="button" onclick="addKhatian(${dIndex})" style="background:#27ae60;">‚ûï ‡¶ñ‡¶§‡¶ø‡ßü‡¶æ‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    `;

    deedContainer.appendChild(block);

    // Add saved khatians if present
    if(data?.khatians?.length) {
      data.khatians.forEach((khatianData) => addKhatian(dIndex, khatianData));
    } else {
      addKhatian(dIndex); // at least one khatian
    }
  }

  function addKhatian(dIndex, data) {
    const khatianList = document.getElementById(`khatianList${dIndex}`);
    if (!khatianList) return;
    const kIndex = khatianList.childElementCount;
    const khatianDiv = document.createElement('div');
    khatianDiv.className = 'khatian-block';

    khatianDiv.innerHTML = `
      <div style="display:flex; align-items:center; gap:10px;">
        <label style="flex:1;">
          ‡¶ñ‡¶§‡¶ø‡ßü‡¶æ‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞: <input type="text" name="khatian${dIndex}_${kIndex}" required placeholder="‡¶ñ‡¶§‡¶ø‡ßü‡¶æ‡¶® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞" value="${data?.khatianNo || ''}" />
        </label>
        <button type="button" onclick="this.closest('.khatian-block').remove()" style="background:#e67e22; color:#fff;">üóëÔ∏è</button>
      </div>
      <label>‡¶¶‡¶æ‡¶§‡¶æ‡¶∞ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶§‡¶•‡ßç‡¶Ø (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï): <input type="text" name="donor${dIndex}_${kIndex}" placeholder="‡¶¶‡¶æ‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ, ‡¶´‡ßã‡¶®, ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ ‡¶á‡¶§‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø" value="${data?.donor || ''}" /></label>
      <label>‡¶ï‡ßç‡¶∞‡ßü‡¶ï‡ßÉ‡¶§ ‡¶ú‡¶Æ‡¶ø (‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂): <input type="number" step="0.01" name="purchase${dIndex}_${kIndex}" required placeholder="‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂" value="${data?.purchase || ''}" /></label>
      <div class="dag-list" id="dagList${dIndex}_${kIndex}"></div>
      <button type="button" onclick="addDag(${dIndex}, ${kIndex})" style="background:#2980b9;">‚ûï ‡¶¶‡¶æ‡¶ó ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    `;

    khatianList.appendChild(khatianDiv);

    // Add saved dags if present
    if(data?.dags?.length) {
      data.dags.forEach(dagData => addDag(dIndex, kIndex, dagData));
    } else {
      addDag(dIndex, kIndex);
    }
  }

  function addDag(dIndex, kIndex, data) {
    const dagList = document.getElementById(`dagList${dIndex}_${kIndex}`);
    if (!dagList) return;
    const dagDiv = document.createElement('div');
    dagDiv.className = 'dag-group';
    dagDiv.innerHTML = `
      <div style="display:flex; align-items:center; gap:10px;">
        <label style="flex:1;">
          ‡¶¶‡¶æ‡¶ó ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞: <input type="text" name="dag${dIndex}_${kIndex}[]" required placeholder="‡¶¶‡¶æ‡¶ó ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞" value="${data?.dagNo || ''}" />
        </label>
        <label style="flex:1;">
          ‡¶¶‡¶æ‡¶ó‡ßá ‡¶Æ‡ßã‡¶ü ‡¶ú‡¶Æ‡¶ø (‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂): <input type="number" step="0.01" name="dagTotal${dIndex}_${kIndex}[]" required placeholder="‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂" value="${data?.dagLand || ''}" />
        </label>
        <button type="button" onclick="this.closest('.dag-group').remove()" style="background:#c0392b; color:#fff;">üóëÔ∏è</button>
      </div>
    `;
    dagList.appendChild(dagDiv);
  }

  addDeedBtn.addEventListener('click', () => {
    createDeedBlock(deedIndex);
    deedIndex++;
  });

  // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶¶‡¶≤‡¶ø‡¶≤ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ
  addDeedBtn.click();

  document.getElementById('landForm').addEventListener('submit', function (e) {
    e.preventDefault();
    const formData = new FormData(this);
    let resultHTML = '';

    for (let d = 0; d < deedIndex; d++) {
      const deedNo = formData.get(`deedNo${d}`);
      const deedDate = formData.get(`deedDate${d}`);
      if (!deedNo || !deedDate) continue;

      resultHTML += `
        <div class="deed-block" style="background:#d6eaf8; border-color:#2980b9; box-shadow:none;">
          <div class="deed-header" style="border-bottom:none; color:#21618c;">
            ‡¶¶‡¶≤‡¶ø‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞: <strong>${deedNo}</strong> &nbsp;&nbsp;&nbsp;&nbsp;
            ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${deedDate}
          </div>
      `;

      resultHTML += `
        <table>
          <thead>
            <tr>
              <th>‡¶ñ‡¶§‡¶ø‡ßü‡¶æ‡¶®</th>
              <th>‡¶¶‡¶æ‡¶§‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø</th>
              <th>‡¶¶‡¶æ‡¶ó</th>
              <th>‡¶¶‡¶æ‡¶ó‡ßá ‡¶ú‡¶Æ‡¶ø</th>
              <th>‡¶ï‡ßç‡¶∞‡ßü ‡¶ú‡¶Æ‡¶ø</th>
              <th>‡¶™‡ßç‡¶∞‡¶æ‡¶™‡ßç‡¶§ ‡¶ú‡¶Æ‡¶ø</th>
            </tr>
          </thead>
          <tbody>
      `;

      let k = 0;
      while (formData.has(`khatian${d}_${k}`)) {
        const khatianNo = formData.get(`khatian${d}_${k}`);
        const donor = formData.get(`donor${d}_${k}`) || '';
        const purchaseLand = parseFloat(formData.get(`purchase${d}_${k}`));
        const dags = formData.getAll(`dag${d}_${k}[]`);
        const dagTotals = formData.getAll(`dagTotal${d}_${k}[]`);

        const totalDagLand = dagTotals.reduce((sum, val) => sum + parseFloat(val), 0);

        for (let i = 0; i < dags.length; i++) {
          const dag = dags[i];
          const dagTotal = parseFloat(dagTotals[i]);
          const received = ((purchaseLand * dagTotal) / totalDagLand).toFixed(2);

          resultHTML += `
            <tr>
              ${i === 0 ? `<td rowspan="${dags.length}">${khatianNo}</td><td rowspan="${dags.length}">${donor}</td>` : ''}
              <td>${dag}</td>
              <td>${dagTotal} ‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂</td>
              <td>${purchaseLand} ‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂</td>
              <td>${received} ‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂</td>
            </tr>
          `;
        }
        k++;
      }

      resultHTML += `
          </tbody>
        </table>
        </div>
      `;
    }

    if (!resultHTML) {
      resultHTML = '<p style="text-align:center; color:#c0392b; font-weight:600;">‡¶ï‡ßã‡¶®‡ßã ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø ‡¶¨‡¶æ ‡¶≠‡ßÅ‡¶≤ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶∞‡ßü‡ßá‡¶õ‡ßá‡•§</p>';
    }

    document.getElementById('result').innerHTML = resultHTML;
  });

  // Save data to localStorage
  document.getElementById('saveBtn').addEventListener('click', () => {
    const saveName = document.getElementById('saveNameInput').value.trim();
    if (!saveName) {
      alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶®‡•§');
      return;
    }
    // ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßã ‡¶´‡¶∞‡ßç‡¶Æ ‡¶°‡¶æ‡¶ü‡¶æ
    const formData = new FormData(document.getElementById('landForm'));
    const dataToSave = {
      deeds: []
    };

    for (let d = 0; d < deedIndex; d++) {
      const deedNo = formData.get(`deedNo${d}`);
      const deedDate = formData.get(`deedDate${d}`);
      if (!deedNo || !deedDate) continue;

      const deedObj = {
        deedNo,
        deedDate,
        khatians: []
      };

      let k = 0;
      while (formData.has(`khatian${d}_${k}`)) {
        const khatianNo = formData.get(`khatian${d}_${k}`);
        if (!khatianNo) break;
        const donor = formData.get(`donor${d}_${k}`) || '';
        const purchase = formData.get(`purchase${d}_${k}`) || '';
        const dags = formData.getAll(`dag${d}_${k}[]`);
        const dagLands = formData.getAll(`dagTotal${d}_${k}[]`);

        const khatianObj = {
          khatianNo,
          donor,
          purchase,
          dags: []
        };

        for (let i = 0; i < dags.length; i++) {
          khatianObj.dags.push({
            dagNo: dags[i],
            dagLand: dagLands[i]
          });
        }

        deedObj.khatians.push(khatianObj);
        k++;
      }
      dataToSave.deeds.push(deedObj);
    }

    // Save as JSON string
    localStorage.setItem(`landData_${saveName}`, JSON.stringify(dataToSave));
    alert(`"${saveName}" ‡¶®‡¶æ‡¶Æ‡ßá ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§`);
    updateSavedList();
  });

  // Load data from localStorage
 // ‡¶≤‡ßã‡¶° ‡¶¨‡¶æ‡¶ü‡¶® ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡¶≤‡ßá ‡¶∏‡ßá‡¶≠‡¶° ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
document.getElementById('loadBtn').addEventListener('click', () => {
  const savedListDiv = document.getElementById('savedList');
  if (savedListDiv.style.display === 'block') {
    // ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶Ü‡¶ó‡ßá‡¶á ‡¶ñ‡ßã‡¶≤‡¶æ ‡¶õ‡¶ø‡¶≤, ‡¶è‡¶ñ‡¶® ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßã
    const loadName = document.getElementById('loadNameInput').value.trim();
    if (!loadName) {
      alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶® ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶®‡¶ø‡¶ö‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡ßá‡¶õ‡ßá ‡¶®‡¶ø‡¶®‡•§');
      return;
    }
    loadSavedData(loadName);
  } else {
    // ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶ì
    updateSavedList(true);
    savedListDiv.style.display = 'block';
  }
});

function loadSavedData(loadName) {
  const savedKeys = Object.keys(localStorage).filter(key => key.startsWith('landData_'));
  const savedNames = savedKeys.map(k => k.replace('landData_', ''));

  // ‡¶Æ‡¶ø‡¶≤ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßã (case insensitive)
  const match = savedNames.find(name => name.toLowerCase() === loadName.toLowerCase());

  if (!match) {
    alert(`"${loadName}" ‡¶®‡¶æ‡¶Æ‡ßá ‡¶ï‡ßã‡¶® ‡¶∏‡ßá‡¶≠‡¶° ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§`);
    return;
  }

  const savedData = localStorage.getItem(`landData_${match}`);
  if (!savedData) {
    alert(`"${loadName}" ‡¶®‡¶æ‡¶Æ‡ßá ‡¶ï‡ßã‡¶® ‡¶∏‡ßá‡¶≠‡¶° ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§`);
    return;
  }

  const dataObj = JSON.parse(savedData);

  // ‡¶´‡¶∞‡ßç‡¶Æ ‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßã
  const deedContainer = document.getElementById('deedContainer');
  deedContainer.innerHTML = '';
  deedIndex = 0;
  dataObj.deeds.forEach(deed => {
    createDeedBlock(deedIndex, deed);
    deedIndex++;
  });

  alert(`"${match}" ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§`);

  // ‡¶≤‡ßã‡¶° ‡¶∂‡ßá‡¶∑‡ßá ‡¶∏‡ßá‡¶≠‡¶° ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶≤‡ßÅ‡¶ï‡¶ø‡ßü‡ßá ‡¶¶‡¶æ‡¶ì
  document.getElementById('savedList').style.display = 'none';
}

// savedList ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®, ‡¶∏‡¶æ‡¶•‡ßá ‡¶≤‡ßã‡¶° ‡¶¨‡¶æ‡¶ü‡¶® ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßá
function updateSavedList(showLoadButtons = false) {
  const savedListDiv = document.getElementById('savedList');
  savedListDiv.innerHTML = '';
  const keys = Object.keys(localStorage).filter(key => key.startsWith('landData_'));

  if (keys.length === 0) {
    savedListDiv.innerHTML = '<p style="text-align:center; color:#666;">‡¶ï‡ßã‡¶®‡ßã ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§</p>';
    return;
  }

  const ul = document.createElement('ul');
  keys.forEach(key => {
    const name = key.replace('landData_', '');
    const li = document.createElement('li');
    li.textContent = name;

    // ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶¨‡¶æ‡¶ü‡¶®
    const delBtn = document.createElement('button');
    delBtn.textContent = '‡¶°‡¶ø‡¶≤‡¶ø‡¶ü';
    delBtn.title = `"${name}" ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®`;
    delBtn.style.backgroundColor = '#e74c3c';
    delBtn.style.color = '#fff';
    delBtn.style.marginLeft = '8px';
    delBtn.style.border = 'none';
    delBtn.style.borderRadius = '4px';
    delBtn.style.padding = '4px 10px';
    delBtn.style.cursor = 'pointer';

    delBtn.addEventListener('click', () => {
      if (confirm(`"${name}" ‡¶§‡¶•‡ßç‡¶Ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?`)) {
        localStorage.removeItem(key);
        updateSavedList(showLoadButtons);
        alert(`"${name}" ‡¶§‡¶•‡ßç‡¶Ø ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§`);
      }
    });
    li.appendChild(delBtn);

    if (showLoadButtons) {
      // ‡¶≤‡ßã‡¶° ‡¶¨‡¶æ‡¶ü‡¶®
      const loadBtn = document.createElement('button');
      loadBtn.textContent = '‡¶≤‡ßã‡¶°';
      loadBtn.title = `"${name}" ‡¶§‡¶•‡ßç‡¶Ø ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®`;
      loadBtn.style.backgroundColor = '#2980b9';
      loadBtn.style.color = 'white';
      loadBtn.style.marginLeft = '8px';
      loadBtn.style.border = 'none';
      loadBtn.style.borderRadius = '4px';
      loadBtn.style.padding = '4px 10px';
      loadBtn.style.cursor = 'pointer';

      loadBtn.addEventListener('click', () => {
        document.getElementById('loadNameInput').value = name;
        loadSavedData(name);
      });
      li.appendChild(loadBtn);
    }

    ul.appendChild(li);
  });

  savedListDiv.appendChild(ul);
}


  // Optional: ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡¶æ‡¶ü‡¶® ‡¶è‡¶¨‡¶Ç ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®

  // ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶¨‡¶æ‡¶ü‡¶® ‡¶°‡¶æ‡¶á‡¶®‡¶æ‡¶Æ‡¶ø‡¶ï ‡¶§‡ßà‡¶∞‡¶ø (‡¶Ø‡¶¶‡¶ø ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá)
  if (!document.getElementById('printBtn')) {
    const printBtn = document.createElement('button');
    printBtn.id = 'printBtn';
    printBtn.textContent = 'üñ®Ô∏è ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®';
    printBtn.style.backgroundColor = '#16a085';
    printBtn.style.color = 'white';
    printBtn.style.marginTop = '15px';
    printBtn.style.padding = '10px 20px';
    printBtn.style.border = 'none';
    printBtn.style.borderRadius = '6px';
    printBtn.style.cursor = 'pointer';
    printBtn.style.display = 'block';
    printBtn.style.marginLeft = 'auto';
    printBtn.style.marginRight = 'auto';

    document.getElementById('result').after(printBtn);

   printBtn.addEventListener('click', () => {
  const content = document.getElementById('result').innerHTML;
  if (!content.trim()) {
    alert('‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶§‡¶æ‡¶∞‡¶™‡¶∞ ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
    return;
  }

  const printWindow = window.open('', '', 'width=900,height=700');
  printWindow.document.write(`
    <html>
    <head>
      <title>‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶Ü‡¶â‡¶ü‡¶™‡ßÅ‡¶ü</title>
      <style>
        @page {
          margin-left: 0.5in;
          margin-right: 0.5in;
          margin-top: 0.5in;
          margin-bottom: 0.5in;
        }
        body {
          font-family: 'Siyam Rupali', Arial, sans-serif;
          padding: 0;
          margin: 0;
          font-size: 10px;
          color: #2c3e50;
          line-height: 1;
        }
        h2.filename {
          text-align: left;
          margin: 0 0 12px;
          font-weight: 700;
          font-size: 14px;
          color: #1a5276;
          border-bottom: 1px solid #2980b9;
          padding-bottom: 6px;
        }
        table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 10px;
          font-size: 10px;
          border: 1px solid #999;
        }
        th, td {
          padding: 2px 4px;  /* padding ‡¶ï‡¶Æ‡¶æ‡¶®‡ßã ‡¶π‡¶≤‡ßã */
          text-align: center;
          font-weight: 500;
          border: 1px solid #999 !important;
          vertical-align: middle;
        }
        /* ‡¶¶‡¶≤‡¶ø‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶ì ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶ï‡¶≤‡¶æ‡¶Æ ‡¶¨‡ßã‡¶≤‡ßç‡¶° */
        th:nth-child(1),
        td:nth-child(1),
        th:nth-child(2),
        td:nth-child(2) {
          font-weight: 700;
        }
        th {
          background: #d6eaf8;
          color: #1a5276;
          font-weight: 600; /* ‡¶è‡¶ü‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Æ‡ßÇ‡¶≤ header ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¨‡ßã‡¶≤‡ßç‡¶° ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */
        }
        .deed-block {
          margin-bottom: 15px;
          padding: 6px 8px;
          border-radius: 6px;
          page-break-inside: avoid;
          border: none !important;
        }
      </style>
    </head>
    <body>
      <h2 class="filename">‡¶ú‡¶Æ‡¶ø‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</h2>
      ${content}
    </body>
    </html>
  `);
  printWindow.document.close();
  printWindow.focus();
  printWindow.print();
  printWindow.close();
});


}

  // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶∏‡ßá‡¶≠‡¶° ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßã
  updateSavedList();

</script>
